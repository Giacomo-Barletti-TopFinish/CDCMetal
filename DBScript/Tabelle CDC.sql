drop SEQUENCE CDC_SEQUENCE;
CREATE SEQUENCE CDC_SEQUENCE START WITH 1 INCREMENT BY 1 CACHE 2;
drop table CDC_DETTAGLIO;

drop table CDC_EXCEL;
CREATE TABLE CDC_EXCEL
(
  IDEXCEL NUMBER(10) NOT NULL,
  NOMEFILE VARCHAR2(200) NOT NULL,
  DATAACQUISIZIONE DATE NOT NULL,
  DATARIFERIMENTO DATE NOT NULL,
  UTENTE VARCHAR2(50) NOT NULL,
  DATI BLOB NOT NULL,
  CONSTRAINT PK_IDEXCEL PRIMARY KEY (IDEXCEL)
);

CREATE INDEX IDX_CDC_EXCEL_2 ON CDC_EXCEL(DATARIFERIMENTO);


CREATE TABLE CDC_DETTAGLIO
(
  IDDETTAGLIO NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
  IDPRENOTAZIONE NUMBER(10) NOT NULL,
  IDEXCEL NUMBER(10) NOT NULL,
  IDVERBALE VARCHAR2(10) NULL,
  DATACOLLAUDO VARCHAR2(10) NOT NULL,
  ACCESSORISTA VARCHAR2(30) NOT NULL,
  PREFISSO VARCHAR2(7) NOT NULL,
  PARTE VARCHAR2(6) NOT NULL,
  COLORE VARCHAR2(5) NOT NULL,
  MISURA NUMBER (4),
  LIVELLODIFF NUMBER (1),
  COMMESSAORDINE VARCHAR2(18) NOT NULL,
  ENTE VARCHAR2(5) NOT NULL,
  UM VARCHAR2(2),
  QUANTITA NUMBER(6),
  ASSEGN VARCHAR2(2),
  AUTO VARCHAR2(5),
  COLLTO VARCHAR2(5),
   QUANTITAVALIDITA VARCHAR2(6),
  LOTTOBLOCCATO VARCHAR2(2),
  VERBALEBLOCCATO VARCHAR2(2),
  DEROGA VARCHAR2(2),
  CONTROLLODIMENSIONALE VARCHAR2(2),
  CONTROLLOESTETICO VARCHAR2(2),
  CONTROLLOFUNZIONALE VARCHAR2(2),
  ESITOTESTCHIMICO VARCHAR2(2),
  TESTFISICO VARCHAR2(2),
  NOTECOLLAUDO VARCHAR2(100),
  ASSEGNAZIONE VARCHAR2(500),
    CONSTRAINT PK_IDDETTAGLIO PRIMARY KEY (IDDETTAGLIO),
  FOREIGN KEY (IDEXCEL)
	  REFERENCES CDC_EXCEL (IDEXCEL) ENABLE

);


CREATE INDEX IDX_CDC_DETTAGLIO_1 ON CDC_DETTAGLIO(IDPRENOTAZIONE);
CREATE INDEX IDX_CDC_DETTAGLIO_2 ON CDC_DETTAGLIO(IDEXCEL);